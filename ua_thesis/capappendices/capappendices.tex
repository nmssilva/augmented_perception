
\chapter{Appendices}

\section{Augmented Perception Package}

The Augmented Perception package is a \gls{ros} package built specifically for the ATLASCAR 2 with the aim to develop a better ball detection for the calibration package and a detection, tracking and labelling system.\\

The package features 3 main nodes:

\begin{itemize}
	\item \texttt{ball\_detection\_node}
	\begin{itemize}
		\item Node used for the development of the camera calibration ball detection algorithm improvement
	\end{itemize}
	\item \texttt{labelling\_node}
	\begin{itemize}
		\item Core of the package. Contains all tools related to detection, tracking and labelling.
	\end{itemize}
	\item \texttt{dataset\_playback\_node}
	\begin{itemize}
		\item Extra feature that is used to check the datasets printed out by the \texttt{labelling\_node}.
	\end{itemize}
\end{itemize}

In order to visualize package functionalities, some \texttt{roslaunch} files were created:

\begin{itemize}
	\item \texttt{ball\_detection\_playback}
	\begin{itemize}
		\item Launches the Rviz and plays the rosbag used for calibration tests. 
		\item The \texttt{ball\_detection\_node} is executed and the detection of the ball can be seen in the Rviz.
	\end{itemize}
	\item \texttt{calibration\_playback}
	\begin{itemize}
		\item Launches the Rviz and plays the rosbag used for calibration tests. 
		\item The \texttt{calibration\_gui} from the \texttt{calibration\_gui} package is executed and the ball in the rosbag is used to simulate calibration.
	\end{itemize}
	\item \texttt{drivers}
	\begin{itemize}
		\item Launches the drivers of all sensors and camera.
	\end{itemize}
	\item \texttt{static\_transform\_publisher}
	\begin{itemize}
		\item Launches the frame publisher
	\end{itemize}	
\end{itemize}

\section{Ball Detection Node Interface}

This node is the core to the camera calibration's ball detection. The node is launched with the following command:

\begin{center}
	\begin{lstlisting}[label={lst:BBox2d} ,language=c++]
	rosrun augmented_perception ball_detection_node\end{lstlisting}
\end{center}

The interface uses keyboard and mouse inputs:

\begin{itemize}
	\item \textbf{SPACEBAR} - Update the background frame
	\item \textbf{P} - Pause the actual frame
	\item \textbf{Mouse Left Click} - Picks the color used in the color fitlering
	\begin{itemize}
		\item Used to click in the ball to get its color
	\end{itemize}
\end{itemize}

\section{Labelling Node Interface}

This node is the core of the augmented perception package. The node is launched with the following command:

\begin{center}
	\begin{lstlisting}[label={lst:BBox2d} ,language=c++]
	rosrun augmented_perception labelling_node\end{lstlisting}
\end{center}

The interface uses keyboard and mouse inputs:

\begin{itemize}
	\item \textbf{Q} - Quit / Close Application
	\item \textbf{C} - Clear Image
	\begin{itemize}
		\item Used to clear the bounding box when tracking an object.
	\end{itemize}
	\item \textbf{L} - Label object
	\begin{itemize}
		\item When the tracking is done, the object is labelled.
	\end{itemize}
	\item \textbf{S} - Save Templates
	\begin{itemize}
		\item When the tracking is done, the templates of the objects tracked can be stored in the \texttt{labelling} folder.
	\end{itemize}
	\item \textbf{M} - Manual Mode On / Off
	\begin{itemize}
		\item Switch between manual mode and semi-automatic mode.
	\end{itemize}
	\item \textbf{P} - Print the dataset
	\begin{itemize}
		\item When the sequence of annotations is done a dataset can be printed out and stored in the \texttt{datasets} folder.
	\end{itemize}
	\item \textbf{Left Mouse Click} - Choose the target to follow
	\begin{itemize}
		\item When on semi-automatic mode, this switches the tracking to manual mode temporarily until the tracking of this object is done.
	\end{itemize}
\end{itemize}

